<?xml version="1.0" encoding="UTF-8" ?>
<robot name="hand" xmlns:xacro="http://ros.org/wiki/xacro">
  <xacro:include filename="$(find sobit_light_description)/urdf/hand/hand.transmission.xacro" />
  <xacro:macro name="hand" params="prefix_hand prefix_finger parent">

    <!--  Joint 9: Gripper left sub -->
    <joint name="${prefix_hand}_l_sub_joint" type="fixed">
      <parent link="${parent}"/>
      <child link="${prefix_hand}_l_sub_link"/>
      <origin xyz="0.009 0.015 0.0" rpy="0 0 0"/>
    </joint>

    <!--  Link 9: Gripper left sub -->
    <link name="${prefix_hand}_l_sub_link">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 ${M_PI/2}"/>
        <geometry>
          <mesh filename="file://$(find sobit_light_description)/meshes/hand/omx1_link9-10_gripper.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="grey"/>
      </visual>

      <collision>
        <origin xyz="0 0 0" rpy="0 0 ${M_PI/2}"/>
        <geometry>
          <mesh filename="file://$(find sobit_light_description)/meshes/hand/omx1_link9-10_gripper.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>

      <inertial>
        <origin xyz="0 0 0" rpy="0 0 ${M_PI/2}"/>
        <mass value="0.2" />
        <inertia ixx="1.0" ixy="0.0" ixz="1.0"
                 iyy="1.0" iyz="0.0"
                 izz="1.0" />
      </inertial>
    </link>

    <!--  Joint 10: Gripper right sub -->
    <joint name="${prefix_hand}_r_sub_joint" type="fixed">
      <parent link="${parent}"/>
      <child link="${prefix_hand}_r_sub_link"/>
      <origin xyz="0.009 -0.015 0.0" rpy="0 0 0"/>
    </joint>

    <!--  Link 10: Gripper right sub -->
    <link name="${prefix_hand}_r_sub_link">
      <visual>
        <origin xyz="0 0 0" rpy="0 ${M_PI} ${M_PI/2}"/>
        <geometry>
          <mesh filename="file://$(find sobit_light_description)/meshes/hand/omx1_link9-10_gripper.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="grey"/>
      </visual>

      <collision>
        <origin xyz="0 0 0" rpy="0 ${M_PI} ${M_PI/2}"/>
        <geometry>
          <mesh filename="file://$(find sobit_light_description)/meshes/hand/omx1_link9-10_gripper.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>

      <inertial>
        <origin xyz="0 0 0" rpy="0 ${M_PI} ${M_PI/2}"/>
        <mass value="0.2" />
        <inertia ixx="1.0" ixy="0.0" ixz="1.0"
                 iyy="1.0" iyz="0.0"
                 izz="1.0" />
      </inertial>
    </link>

    <!--  Joint 11: Gripper Finger Left -->
    <joint name="${prefix_hand}_l_${prefix_finger}_joint" type="prismatic">
      <parent link="${prefix_hand}_l_sub_link"/>
      <child link="${prefix_hand}_l_${prefix_finger}_link"/>
      <origin xyz="0.0 0.04 0.0" rpy="0 0 0"/>
      <axis xyz="0 1 0"/>
      <limit velocity="4.8" effort="1" lower="${-0.055+0.02675}" upper="0.0" />
    </joint>

    <!--  Link 11: Gripper Finger Left -->
    <link name="${prefix_hand}_l_${prefix_finger}_link">
      <visual>
        <origin xyz="0.0 0.0 0" rpy="0 0 ${M_PI/2}"/>
        <geometry>
          <mesh filename="file://$(find sobit_light_description)/meshes/hand/omx1_link11-12_finger.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="grey"/>
      </visual>

      <collision>
        <origin xyz="0.0 0.0 0" rpy="0 0 ${M_PI/2}"/>
        <geometry>
          <mesh filename="file://$(find sobit_light_description)/meshes/hand/omx1_link11-12_finger.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>

      <inertial>
        <origin xyz="0.0 0.0 0" rpy="0 0 ${M_PI/2}"/>
        <mass value="0.2" />
        <inertia ixx="1.0" ixy="0.0" ixz="1.0"
                 iyy="1.0" iyz="0.0"
                 izz="1.0" />
      </inertial>
    </link>

    <!--  Joint 12: Gripper Finger Right -->
    <joint name="${prefix_hand}_r_${prefix_finger}_joint" type="prismatic">
      <parent link="${prefix_hand}_r_sub_link"/>
      <child link="${prefix_hand}_r_${prefix_finger}_link"/>
      <origin xyz="0.0 -0.04 0.0" rpy="0 0 0"/>
      <axis xyz="0 -1 0"/>
      <limit velocity="4.8" effort="1" lower="0.0" upper="${-0.055+0.02675}" />
      <mimic joint="${prefix_hand}_l_${prefix_finger}_joint" multiplier="1"/>
    </joint>

    <!--  Link 12: Gripper Finger Right -->
    <link name="${prefix_hand}_r_${prefix_finger}_link">
      <visual>
        <origin xyz="0.0 -0.0 0" rpy="0 ${M_PI} ${M_PI/2}"/>
        <geometry>
          <mesh filename="file://$(find sobit_light_description)/meshes/hand/omx1_link11-12_finger.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="grey"/>
      </visual>

      <collision>
        <origin xyz="0.0 -0.0 0" rpy="0 ${M_PI} ${M_PI/2}"/>
        <geometry>
          <mesh filename="file://$(find sobit_light_description)/meshes/hand/omx1_link11-12_finger.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>

      <inertial>
        <origin xyz="0.0 -0.0 0" rpy="0 ${M_PI} ${M_PI/2}"/>
        <mass value="0.2" />
        <inertia ixx="1.0" ixy="0.0" ixz="1.0"
                 iyy="1.0" iyz="0.0"
                 izz="1.0" />
      </inertial>
    </link>

    <!--  Joint 13: Gripper Tip Left -->
    <joint name="${prefix_hand}_l_tip_joint" type="fixed">
      <parent link="${prefix_hand}_l_${prefix_finger}_link"/>
      <child link="${prefix_hand}_l_tip_link"/>
      <origin xyz="${0.0345+0.0375/2} -0.0145 0.0" rpy="0 0 0"/>
    </joint>

    <!--  Link 13: Gripper Tip Left -->
    <link name="${prefix_hand}_l_tip_link">
      <visual>
        <origin xyz="0.0 -0.0 0" rpy="0 0 ${M_PI/2}"/>
        <geometry>
          <mesh filename="file://$(find sobit_light_description)/meshes/hand/omx1_link13-14_finger.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="grey"/>
      </visual>

      <collision>
        <origin xyz="0.0 -0.0 0" rpy="0 0 ${M_PI/2}"/>
        <geometry>
          <mesh filename="file://$(find sobit_light_description)/meshes/hand/omx1_link13-14_finger.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>

      <inertial>
        <origin xyz="0.0 -0.0 0" rpy="0 0 ${M_PI/2}"/>
        <mass value="0.2" />
        <inertia ixx="1.0" ixy="0.0" ixz="1.0"
                iyy="1.0" iyz="0.0"
                izz="1.0" />
      </inertial>
    </link>

    <!--  Joint 14: Gripper Tip Right -->
    <joint name="${prefix_hand}_r_tip_joint" type="fixed">
      <parent link="${prefix_hand}_r_${prefix_finger}_link"/>
      <child link="${prefix_hand}_r_tip_link"/>
      <origin xyz="${0.0345+0.0375/2} 0.0145 0.0" rpy="0 0 0"/>
    </joint>

    <!--  Link 14: Gripper Tip Right -->
    <link name="${prefix_hand}_r_tip_link">
      <visual>
        <origin xyz="0.0 -0.0 0" rpy="0 ${M_PI} ${M_PI/2}"/>
        <geometry>
          <mesh filename="file://$(find sobit_light_description)/meshes/hand/omx1_link13-14_finger.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="grey"/>
      </visual>

      <collision>
        <origin xyz="0.0 -0.0 0" rpy="0 ${M_PI} ${M_PI/2}"/>
        <geometry>
          <mesh filename="file://$(find sobit_light_description)/meshes/hand/omx1_link13-14_finger.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>

      <inertial>
        <origin xyz="0.0 -0.0 0" rpy="0 ${M_PI} ${M_PI/2}"/>
        <mass value="0.2" />
        <inertia ixx="1.0" ixy="0.0" ixz="1.0"
                 iyy="1.0" iyz="0.0"
                 izz="1.0" />
      </inertial>
    </link>

    <!-- Joint 15: End Effector -->
    <joint name="end_effector_joint" type="fixed">
      <origin xyz="${0.0935+0.0375/2} 0.0 0.0" rpy="0 0 0"/>
      <parent link="arm_6_link"/>
      <child link="${prefix_hand}_end_effector_link"/>
    </joint>

    <!-- Link 15: End Effector -->
    <link name="${prefix_hand}_end_effector_link">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <box size="0.01 0.01 0.01" />
        </geometry>
        <material name="red"/>
      </visual>

      <inertial>
        <origin xyz="0 0 0" />
        <mass value="0.2" />
        <inertia ixx="1.0" ixy="0.0" ixz="1.0"
                 iyy="1.0" iyz="0.0"
                 izz="1.0" />
      </inertial>
    </link>


    <xacro:hand_transmission prefix_hand="${prefix_hand}" prefix_finger="${prefix_finger}_" />

  </xacro:macro>
</robot>
